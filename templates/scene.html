<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/public/navbar.css">
  <title>360 Test</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
    }

    #viewer360 {
      position: relative;
      width: 800px;
      height: 400px;
      margin: 20px auto;
      overflow: hidden;
      border: 2px solid black;
    }

    #scene360 {
      width: 100%;
      height: 100%;
      cursor: grab;
      overflow: hidden;
    }

    #sceneImage {
      height: 100%;
      width: auto;
      min-width: 200%;
      user-select: none;
      pointer-events: none;
      transform: translateX(0px);
    }

    .hotspot {
      position: absolute;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      border: none;
      background: red;
      color: white;
      font-size: 18px;
      cursor: pointer;
      z-index: 10;
    }

    .scene-controls {
  margin-top: 15px;
}

.scene-controls button {
  padding: 10px 18px;
  margin: 5px;
  font-size: 16px;
  cursor: pointer;
}

#statusBar {
  margin-top: 10px;
  font-weight: bold;
}

  </style>
</head>

<body>
  <div class="container">
    <!-- Header / Navbar -->
    <nav>
      <div class="logo"></div>
      <img src="/public/images/logo.gif" alt="logo" class="logo-icon" />
      <ul class="nav-links">
        <li><a href="/api/trainee/quizz">Quizzes</a></li>
        <li><a href="/api/trainee/scene">Warehouse safety</a></li>
        <li><a href="/api/trainee/hazard">Hazards</a></li>
        <li><a href="/api/trainee/360scene">Hazard Perception</a></li>
        <li><a href="/api/trainee/forklift">Forklift</a></li>
        <li><a href="/api/trainee/handling">Manual Handling</a></li>
      </ul>
      <div class="nav-buttons">
        <a href="/logout" class="btn btn-login">Logout</a>
      </div>
    </nav>


    <h1>Hazard Perception Training</h1>
    <p>Drag the image left and right</p>

    <div id="viewer360">
      <div id="scene360">
        <img id="sceneImage" src="public/images/warehouse1.png" alt="scene">

      </div>

      <button class="hotspot" style="top:60%; left:25%;" data-hazard="Spillage">⚠</button>
      <button class="hotspot" style="top:50%; left:55%;" data-hazard="Exit Blocked">⚠</button>
    </div>
    <!-- Progress & Score -->
    <div id="statusBar">
      <p id="progressText">Scene 1 of 3</p>
      <p id="scoreText">Score: 0</p>
    </div>

    <!-- Controls -->
    <div class="scene-controls">
      <button id="prevBtn">Previous Scene</button>
      <button id="nextBtn">Next Scene</button>
      <button id="submitBtn" style="display:none;">Submit Module</button>
    </div>

    <!-- Footer -->
    <footer class="footer">

      <div class="footer-container">


        <!-- About -->
        <div class="footer-section" id="first-section">
          <img src="/public/images/logo.gif" alt="SafeTrain360 Logo" width="120" />

        </div>

        <!-- Training Modules -->
        <div class="footer-section">
          <h4>Training Modules</h4>
          <ul>
            <li><a href="#">360° Hazard Perception Training</a></li>
            <li><a href="#">Manual Handling Safety</a></li>
            <li><a href="#">Forklift & Equipment Safety</a></li>
            <li><a href="#">Workplace Risk Awareness</a></li>
          </ul>
        </div>

        <!-- Resources -->
        <div class="footer-section">
          <h4>Resources</h4>
          <ul>
            <li><a href="#">Health & Safety Guidelines</a></li>
            <li><a href="#">Employee Training Support</a></li>
            <li><a href="#">Frequently Asked Questions</a></li>
            <li><a href="#">Compliance & Standards</a></li>
          </ul>
        </div>

        <!-- Contact -->
        <div class="footer-section">
          <h4>Contact Us</h4>
          <p>
            SafeTrain360 Pvt. Ltd.<br>
            Logistics Training Center<br>
            Industrial Area, Kathmandu<br>
            Nepal
          </p>
          <p>
            Email: <a href="mailto:support@safetrain360.com">support@safetrain360.com</a><br>
            Phone: +977-1-5550000
          </p>
        </div>

      </div>

      <!-- Bottom Bar -->
      <div class="footer-bottom">
        <p>
          © 2026 SafeTrain360. All Rights Reserved.
        </p>
        <p>
          <a href="#">Privacy Policy</a> |
          <a href="#">Terms of Use</a> |
          <a href="#">Accessibility</a>
        </p>
        <p class="disclaimer">
          This training system is intended for educational purposes only and does not replace
          site-specific safety procedures, risk assessments, or professional safety advice.
        </p>
      </div>
    </footer>
  </div>
  <script>
   document.addEventListener("DOMContentLoaded", () => {

  const scene = document.getElementById("scene360");
  const img = document.getElementById("sceneImage");

  const progressText = document.getElementById("progressText");
  const scoreText = document.getElementById("scoreText");

  const nextBtn = document.getElementById("nextBtn");
  const prevBtn = document.getElementById("prevBtn");
  const submitBtn = document.getElementById("submitBtn");

  const scenes = [
    "public/images/warehouse1.png",
    "public/images/warehouse2.png",
    "public/images/warehouse3.png"
  ];

  let currentScene = 0;
  let score = 0;

  /* ===== Drag logic ===== */
  let dragging = false;
  let lastX = 0;
  let posX = 0;

  function resetDrag() {
    posX = 0;
    img.style.transform = "translateX(0px)";
  }

  scene.addEventListener("mousedown", e => {
    dragging = true;
    lastX = e.clientX;
    scene.style.cursor = "grabbing";
  });

  window.addEventListener("mouseup", () => {
    dragging = false;
    scene.style.cursor = "grab";
  });

  window.addEventListener("mousemove", e => {
    if (!dragging) return;
    const dx = e.clientX - lastX;
    lastX = e.clientX;
    posX += dx;
    img.style.transform = `translateX(${posX}px)`;
  });

  /* ===== Scene Handling ===== */
  function loadScene(index) {
    if (!scenes[index]) return;

    currentScene = index;
    img.src = scenes[index];
    resetDrag();

    document.querySelectorAll(".hotspot").forEach(h => {
      h.style.display = "block";
      h.dataset.clicked = "false";
    });

    updateUI();
  }

  function updateUI() {
    progressText.textContent = `Scene ${currentScene + 1} of ${scenes.length}`;
    scoreText.textContent = `Score: ${score}`;

    prevBtn.disabled = currentScene === 0;

    if (currentScene === scenes.length - 1) {
      nextBtn.style.display = "none";
      submitBtn.style.display = "inline-block";
    } else {
      nextBtn.style.display = "inline-block";
      submitBtn.style.display = "none";
    }
  }

  /* ===== Auto move when hazards complete ===== */
  function checkAllHazardsFound() {
    const remaining = [...document.querySelectorAll(".hotspot")]
      .some(h => h.style.display !== "none");

    if (!remaining && currentScene < scenes.length - 1) {
      setTimeout(() => {
        loadScene(currentScene + 1);
      }, 800);
    }
  }

  /* ===== Hotspots ===== */
  document.querySelectorAll(".hotspot").forEach(h => {
    h.addEventListener("click", () => {

      if (h.dataset.clicked === "true") return;

      h.dataset.clicked = "true";
      h.style.display = "none";

      score++;
      scoreText.textContent = `Score: ${score}`;

      checkAllHazardsFound();
    });
  });

  /* ===== Buttons ===== */
  nextBtn.addEventListener("click", () => {
    loadScene(currentScene + 1);
  });

  prevBtn.addEventListener("click", () => {
    loadScene(currentScene - 1);
  });

  submitBtn.addEventListener("click", () => {
    alert(
      `Module Completed!\n\nFinal Score: ${score}\nScenes Completed: ${scenes.length}`
    );

    sessionStorage.setItem("finalScore", score);
    sessionStorage.setItem("completed", "true");
  });

  /* Init */
  loadScene(0);

});

  </script>

</body>

</html>